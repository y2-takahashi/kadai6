<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>MapAPI</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <!-- MapArea -->
  <div id="view"></div>
  <div id="myMap" style="width:50%;height:50%;"></div>
  <!-- /MapArea -->

  <!-- jQuery&GoogleMapsAPI -->
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src='https://www.bing.com/api/maps/mapcontrol?callback=GetMap&key=AqjbKmgjtR88SFgZd0YP-UYaY3dFY3fBKDs8S0XMTY7V8K8uMN4EsY4bQMwI4W0w'
    async defer></script>
  <script src="js/BmapQuery.js"></script>
  <!-- jQuery&GoogleMapsAPI -->
  <select  id="type">
    <option value="road" selected>road</option>
    <option value="aerial" selected>aerial</option>
  </select>


  <script>
  // Bing Maps Init
  let map, typeid, type;
    function GetMap(){
      const map = new Microsoft.Maps.Map('#myMap', {
        center: new Microsoft.Maps.Location(47.6149, -122.1941),
        mapTypeId: Microsoft.Maps.MapTypeId.load,
        zoom: 16
      });
    }
    // select MapTypeID
    document.getElementById("type").onchange = function(){
      typeid = this.value; //selectboxの値を取得
      // load を選択
      if(typeid == "load") type = {
        mapTypeId:Microsoft.Maps.MapTypeId.load};
      // aerialを選択
      if(typeid == "aerial") type = {
        mapTypeId: Microsoft.Maps.MapTypeId.aerial}; 
      //MapType追加設定
      map.setView(type);
    }
  </script>